version: '3.8'

services:
  novnc-desktop:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: novnc-desktop
    ports:
      - "8080:8080"
    volumes:
      - ./home-desktop:/home/desktop
    # For Docker: pass host user's UID/GID to reconfigure desktop user
    # Container starts as root, then docker-entrypoint.sh switches to desktop user
    environment:
      - HOST_UID=${UID:-1000}
      - HOST_GID=${GID:-1000}
    restart: unless-stopped
    stdin_open: true
    tty: true
